(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[844],{6431:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/calendar",function(){return t(32960)}])},33522:function(e,n,t){"use strict";var r=t(85893),i=t(67473),o=t(42283);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}n.Z=function(e){var n=e.control,t=e.name,s=e.required,c=void 0!==s&&s,u=l(e,["control","name","required"]),d=(0,o.bc)({name:t,control:n,rules:{required:c},defaultValue:"",shouldUnregister:!0}).field,f=d.onChange,m=d.onBlur,h=d.name,p=d.value,x=d.ref;return(0,r.jsx)(i.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){a(e,n,t[n])}))}return e}({margin:"dense",onChange:f,onBlur:m,value:p,name:h,inputRef:x},u))}},63020:function(e,n){"use strict";n.Z=function(e){return e.reduce((function(e,n){return Object.assign(e,{legumes:e.legumes||n.legumes,fruitsNuts:e.fruitsNuts||n.fruitsNuts,healthyFats:e.healthyFats||n.healthyFats,dairy:e.dairy||n.dairy,meat:e.meat||n.meat,wholeGrains:e.wholeGrains||n.wholeGrains,vegetables:e.vegetables||n.vegetables,alcohol:e.alcohol||n.alcohol,fishSeafood:e.fishSeafood||n.fishSeafood})}),{})}},32960:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return ie},default:function(){return oe}});var r=t(85893),i=t(23544),o=t(96827),a=t(74201),l=t(83366),s=t(584),c=t(20466),u=t(43703),d=t(4135),f=(t(4120),t(11057)),m=t(99226),h=t(56863),p=t(2734),x=t(16628),g=t(98456),j=t(67294),y=t(35077),b=t(9669),v=t.n(b),Z=t(88767),w=t(28520),O=t.n(w),S=t(54776),P=t(98396),C=t(50657),k=t(37645),E=t(93946),N=t(6514),_=t(86886),D=t(58951),T=t(15861),A=t(78462),F=t(70891),G=t(18987),I=t(69661),M=t(79953),W=t(31425),z=t(33522),Q=t(41733),R=t(69204),q=t(23855),B=t(63020),V=t(31812);function X(e){var n=e.onConfirm,t=(e.onCancel,e.disabled),i=e.title,o=e.message,a=e.children,l=e.confirmText,s=e.cancelText,c=(0,j.useState)(!1),u=c[0],d=c[1],m=(0,j.useState)(null),h=m[0],p=m[1];(0,j.useEffect)((function(){u&&(null===h&&p(3),h>0&&setTimeout((function(){return p(h-1)}),1e3))}),[u,h]);var x=function(){d(!1),p(null)};return(0,r.jsxs)(r.Fragment,{children:[(0,j.cloneElement)(a,{onClick:function(){d(!0)}}),(0,r.jsxs)(C.Z,{open:u,onClose:x,"aria-labelledby":"confirm-dialog-title","aria-describedby":"confirm-dialog-description",children:[(0,r.jsx)(k.Z,{id:"confirm-dialog-title",children:i}),(0,r.jsx)(N.Z,{children:(0,r.jsx)(D.Z,{id:"confirm-dialog-description",sx:{whiteSpace:"pre-line"},children:o})}),(0,r.jsxs)(W.Z,{children:[(0,r.jsx)(f.Z,{onClick:x,variant:"outlined",children:s}),(0,r.jsx)(V.Z,{loading:0!==h,disabled:t,variant:"contained",color:"error",loadingIndicator:h,onClick:function(){n(),d(!1)},children:l})]})]})]})}var L=t(42283);function U(e,n,t,r,i,o,a){try{var l=e[o](a),s=l.value}catch(c){return void t(c)}l.done?n(s):Promise.resolve(s).then(r,i)}function J(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var H=(0,j.forwardRef)((function(e,n){return(0,r.jsx)(S.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){J(e,n,t[n])}))}return e}({direction:"up",ref:n},e))}));function K(e){var n,t=e.children,i=e.meal,o=(0,L.cI)(),l=o.control,s=o.handleSubmit,c=(0,j.useState)(!1),u=c[0],d=c[1],m=(0,p.Z)(),h=(0,Z.useQueryClient)(),x=(0,j.useState)(0),g=x[0],y=x[1],b=(0,j.useState)({legumes:!1,fruitsNuts:!1,healthyFats:!1,dairy:!1,meat:!1,wholeGrains:!1,vegtables:!1,alcohol:!1,fishSeafood:!1}),w=b[0],S=b[1],J=(0,P.Z)(m.breakpoints.down("sm"));(0,j.useEffect)((function(){S((0,B.Z)([i]))}),[i,S]),(0,j.useEffect)((function(){var e=0;Object.entries(w).forEach((function(n){return!0===n[1]&&e++})),y(e)}),[w,y]);var K,Y=function(){d(!1)},$=(K=O().mark((function e(n){var t;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.content,ee.mutate({content:t,mealId:i.id});case 2:case"end":return e.stop()}}),e)})),function(){var e=this,n=arguments;return new Promise((function(t,r){var i=K.apply(e,n);function o(e){U(i,t,r,o,a,"next",e)}function a(e){U(i,t,r,o,a,"throw",e)}o(void 0)}))}),ee=(0,Z.useMutation)((function(e){return v().post("/api/comments",e)}),{onSuccess:function(){h.invalidateQueries(["meals"])}}),ne=(0,Z.useMutation)((function(e){return v().delete("/api/meals",e)}),{onSuccess:function(){h.invalidateQueries(["meals"])}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.Z,{maxWidth:"sm",fullWidth:!0,fullScreen:J,open:u,onClose:Y,TransitionComponent:H,"aria-labelledby":"responsive-dialog-title",children:[(0,r.jsxs)(k.Z,{id:"responsive-dialog-title",children:[(0,r.jsx)(X,{onConfirm:function(){ne.mutate({mealId:i.id})},confirmText:"Delete Meal",cancelText:"On second thought...",title:"Are you sure you want to delete this meal?",message:'Clicking "Delete Meal" will, believe it or not, delete the meal.',children:(0,r.jsx)(E.Z,{children:(0,r.jsx)(Q.Z,{})})}),(0,a.Z)(new Date(i.createdAt),"PP p")]}),(0,r.jsx)(N.Z,{children:(0,r.jsxs)(_.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(_.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsxs)(D.Z,{children:[(0,r.jsxs)(T.Z,{children:["Meal: ",i.food]}),(0,r.jsxs)(T.Z,{children:["Sugar: ",i.sugar," grams"]}),(0,r.jsxs)(T.Z,{children:["Med Points: ",g,"/9"," "]})]})}),(0,r.jsxs)(_.ZP,{item:!0,xs:12,sm:6,children:["Comments:",(0,r.jsx)(A.Z,{children:(null===i||void 0===i||null===(n=i.comments)||void 0===n?void 0:n.length)>0?(0,r.jsx)(r.Fragment,{children:i.comments.map((function(e){return(0,r.jsxs)(F.ZP,{children:[(0,r.jsx)(G.Z,{children:(0,r.jsx)(I.Z,{alt:e.user.name,src:e.user.image,sx:{width:45,height:45}})}),(0,r.jsx)(M.Z,{primary:e.content,secondary:"".concat(e.user.name," \u2022 ").concat((0,R.Z)((0,q.Z)(e.createdAt),new Date))})]},e.id)}))}):(0,r.jsx)(F.ZP,{children:(0,r.jsx)(M.Z,{primary:"No comments yet"})})}),(0,r.jsxs)("form",{onSubmit:s($),children:[(0,r.jsx)(z.Z,{label:"New Comment",placeholder:"Excellent!",fullWidth:!0,name:"content",variant:"outlined",control:l}),(0,r.jsx)(V.Z,{loading:ee.isLoading,variant:"contained",type:"submit",children:"Send"})]})]})]})}),(0,r.jsx)(W.Z,{children:(0,r.jsx)(f.Z,{fullWidth:!0,variant:"contained",onClick:Y,color:"primary",children:"Ok"})})]}),(0,j.cloneElement)(t,{onClick:function(){d(!0)}})]})}var Y="PREV",$="NEXT",ee={"en-US":y.Z},ne=(0,o.lD)({format:a.Z,parse:l.Z,startOfWeek:s.Z,getDay:c.Z,locales:ee}),te=function(e){var n=e.localizer.messages,t=e.label,i=(e.classes,e.views),o=e.onView,a=e.onNavigate;return(0,r.jsxs)(m.Z,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",alignItems:"center",marginBottom:"10px",fontSize:"16px"},children:[(0,r.jsxs)(h.Z,{children:[(0,r.jsx)(f.Z,{type:"button",onClick:function(){return a(Y)},children:n.previous}),(0,r.jsx)(f.Z,{type:"button",onClick:function(){return a($)},children:n.next})]}),(0,r.jsx)("span",{className:"rbc-toolbar-label",children:t}),(0,r.jsx)(h.Z,{children:function(e){if(i.length>1)return i.map((function(n){return(0,r.jsx)(f.Z,{type:"button",onClick:function(){return o(n)},children:e[n]},n)}))}(n)})]})};function re(e){var n=e.event;return(0,r.jsx)(K,{meal:n,children:(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{style:{color:"white"},children:n.food}),n.details&&":  "+n.details]})})}var ie=!0,oe=(0,i.withSuperJSONPage)((function(e){var n=e.initalMeals,t=(0,j.useState)({start:(0,u.Z)(new Date),end:(0,d.Z)(new Date)}),i=t[0],a=t[1],l=(0,Z.useQuery)(["meals",i],(function(){return v().get("/api/meals",{params:{periodStart:i.start.getTime(),periodEnd:i.end.getTime()}}).then((function(e){return e.data}))}),{initialData:n}),s=l.data,c=l.isError,f=l.isLoading,h=(0,p.Z)();return c?"oops something broke":(0,r.jsxs)(m.Z,{sx:{height:"100%"},children:[(0,r.jsx)(x.Z,{in:f,style:{transitionDelay:f?"800ms":"0ms"},unmountOnExit:!0,children:(0,r.jsx)(m.Z,{sx:{position:"absolute",left:"50%",top:"50%",zIndex:20},children:(0,r.jsx)(g.Z,{color:"secondary"})})}),(0,r.jsx)(o.f,{localizer:ne,onRangeChange:function(e){Array.isArray(e)?a({start:e[0],end:e[e.length-1]}):a(e)},views:{month:!0,week:!0,day:!0,agenda:!0},events:s||[],startAccessor:function(e){return new Date(e.createdAt)},endAccessor:function(e){return new Date(e.createdAt)},style:{height:"100%"},titleAccessor:function(e){return e.food},components:{event:re,toolbar:te},eventPropGetter:function(){return{style:{backgroundColor:"".concat(h.palette.secondary.main," !important")}}},slotPropGetter:function(){return{style:{backgroundColor:"".concat(h.palette.secondary.main," !important")}}},dayPropGetter:function(){return{style:{backgroundColor:h.palette.primary.main,color:h.palette.primary.contrastText}}}})]})}))}},function(e){e.O(0,[770,269,544,857,776,774,888,179],(function(){return n=6431,e(e.s=n);var n}));var n=e.O();_N_E=n}]);